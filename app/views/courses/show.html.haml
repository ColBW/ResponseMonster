%center
  %h3=@course.title + "-" + @course.section
  %h3=@course.name
  %h4="#{User.find(@course.teacher_id).first_name} #{User.find(@course.teacher_id).last_name}"
  %h4
    - if Date.new(Date.today.year, 8, 1) == @course.term
      Fall
    - else
      Spring

%br
- if is_teacher?(@course) || is_admin?
  = link_to 'Create New Survey', new_course_survey_path(@course), class: "btn"
%br

%h2
  Surveys
%table.table
  %thead
    %tr
      %th
        Name
      %th
        Start Time
      %th
        End Time
      - if is_teacher?(@course)
        %th
          Edit
        %th
          Activate
        %th
          Delete
  %tbody
    - @surveys.each do |survey|
      %tr
        %td
          - if survey.is_active || is_admin? || is_teacher?(@course)
            - if survey.password
              = link_to survey.name, login_course_survey_path(@course, survey), class: "btn"
            - else
              = link_to survey.name, course_survey_path(@course, survey), class: "btn"
          - else
            = survey.name
        %td
          - if survey.start_time.nil?
            = @course.term
          - else
            = survey.start_time
        %td
          - if survey.start_time.nil?
            = Date.new(Date.today.year, 12, 24)
          - else
            = survey.end_time
        - if is_teacher?(@course)
          %td
            = link_to "Edit", edit_course_survey_path(@course, survey), class: "btn"
          %td
            - if survey.is_active
              = link_to "Deactive Survey", deactivate_course_survey_path(@course, survey), class: "btn"
            - else
              = link_to "Activate Survey", activate_course_survey_path(@course, survey), class: "btn"
          %td
            = link_to "Delete", [@course, survey], method: :delete, confirm: "Are you sure you want to delete this survey?", title: "Delete #{survey.name}", class: "btn btn-warning"

- if !is_teacher?(@course) && !@finished_surveys.empty?
  %h2
    Past Submissions
  %table.table
    %thead
      %tr
        %th
          Name
        %th
          Time Submitted
        %th
          Grade
    %tbody
      - @finished_surveys.each do |survey|
        - survey.each do |info|
          %tr
            %td
              = link_to info[1], summary_course_survey_path(@course, info[0])
            %td
              = info[2]
            %td


- if is_teacher?(@course)
  = link_to 'Create New Survey', new_course_survey_path(@course), class: "btn"

- if is_admin?
  = link_to 'Edit', edit_course_path(@course), class: "btn"
  %br
  %br
  = link_to 'Back', courses_path, class: "btn"
